config:
    target: "http://localhost:3000"
    phases:
        - duration: 100
          arrivalRate: 4
        #- duration: 100
          #arrivalRate: 5
        #- duration: 100
          #arrivalRate: 3
    processor: "./functions.js"

scenarios:
    - name: "User that stays close by and clicks often"
      weight: 4
      engine: "socketio"
      flow:
          - function: "randomCloseby"
          - get:
              url: "/"
          - emit:
              channel: "r"
              data: "{{ chunk }}"
          - think: 1
          - loop:
               - function: "randomCloseby"
               - emit:
                   channel: "p"
                   data:
                      chunk: "{{ chunk }}"
                      i: "{{ $randomNumber(0, 399) }}"
               - think: 1
            count: 100

    - name: "Flyer: user that flies across the map loading many chunks"
      weight: 1
      engine: "socketio"
      flow:
          - get:
              url: "/"
          - loop:
              - function: "randomChunk"
              - emit:
                  channel: "r"
                  data: "{{ chunk }}"
              - think: 1
              - emit:
                  channel: "p"
                  data:
                     chunk: "{{ chunk }}"
                     i: "{{ $randomNumber(0, 399) }}"
              - think: 1
            count: 50
